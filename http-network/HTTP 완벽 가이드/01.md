# HTTP 개관

## HTTP 란?

텍스트 기반의 통신 규약, 인터넷 데이터 통신 프로토콜이다. 전 세계의 브라우저, 서버, 웹 어플리케이션은 모두 HTTP 를 이용해 통신한다.

## 미디어 타입(MIME)

인터넷은 수천 가지의 데이터 타입을 다루기 때문에 MIME 이라는 데이터 포멧 라벨을 붙인다.

```http
# MIME 타입 예시

Content-type: image/jpeg
content-length: 12984
```

모든 웹 서버는 브라우저에게 HTTP 응답을 할 때 MIME 타입 라벨을 부착해서 보낸다.

## URI

모든 리소스는 고유 주소를 갖고 있다. 이를 URL 라고 부른다. URI 에는 URL/URN 두 가지 종류로 나뉘지만 오늘날 대부분 URI는 URL이라고 봐도 큰 문제가 되지 않는다.

## 트렌잭션

HTTP 트랜잭션은 요청(클라이언트 -> 서버)과 응답(서버 -> 클라이언트) 로 이루어진다.

## 메소드

HTTP 요청의 종류를 의미한다.

## 메시지

HTTP 메시지는 줄 단위의 문자열이다. 클라이언트 -> 서버 상태의 HTTP 메시지를 `요청 메시지` 라고 부른다. 반대는 `응답 메시지` 라고 부른다.

```http
# 요청 메시지
(시작줄) GET /test/text.txt HTTP/1.0
(헤 더) Accept: text/*
       Accept-Language: en, fr


# 응답 메시지
(시작줄) HTTP/1.0 200 OK
(헤 더) Content-type: text/plain
       Content-length: 19

(응 답) Hello World!
```

#### 시작

메시지의 첫 줄, 어떤 요청을 했는지, 어떤 응답을 했는지 나타낸다.

#### 헤더

0개 이상의 헤더가 필드가 등록된다. `:` 를 기준으로 key-value 가 이어진다.
헤더는 항상 빈 줄로 끝이난다.

#### 본문

시작, 헤더와 달리 이진 데이터를 포함 할 수 있다.(이미지, mp3 파일, 동영상 등이 이진파일이다.) 텍스트 포함도 물론 가능하다.



## TCP 커넥션

메시지가 TCP 커넥션을 통해 옮겨지는 과정을 알아본다.



### TCP/IP

```
(어플리케이션 계층) HTTP
(전송 계층)       TCP
(네트워크 계층)    IP
(데이터 링크 계층)  네트워크를 위한 링크 인터페이스
(물리 계층)       물리적인 네트워크 하드웨어
```

HTTP는 어플리케이션 계층 프로토콜이다. HTTP가 네트워크 통신의 핵심 사항을 신경쓰지는 않는데, 대신 신뢰성있는 프로토콜인 TCP/IP 에게 이 역할을 맡긴다. TCP는 다음을 제공한다.

- 오류없는 데이터 전송
- 순서에 맞는 전달(데이터는 언제나 보낸 순서대로 도착한다.)
- 조각나지 않는 데이터 스트림

TCP/IP는 TCP와 IP가 층을 이루는 패킷 교환 프로토콜 계층이다. TCP/IP는 네트워크/하드웨어에 구애받지 않고 어디로든 통신할 수 있도록 해준다. 네트워크적 관점에서 HTTP는 TCP의 상위 계층으로 메시지를 전송하기 위해 TCP를 이용한다.

### 접속, IP 주소와 포트번호

HTTP 클라이언트가 메시지 전송을 하기 전에 IP 주소와 포트번호를 통해 클라이언트와 서버 사이에 TCP/IP 커넥션을 맺어야한다. TCP에서는 서버 컴퓨터에 대한 IP 주소와 이용될 포트번호를 필요로 한다.

**동작 원리**

1. 브라우저는 서버의 URL에서 호스트 명을 추출한다.
2. 브라우저는 서버의 호스트 명을 IP로 변환한다.
3. 브라우저는 URL에 포트번호가 있다면 추출한다.
4. 브라우저는 웹 서버와 TCP 커넥션을 맺는다.
5. 브라우저는 서버에 HTTP 요청을 보낸다.
6. 서버는 브라우저에 HTTP 응답을 보낸다.
7. 커넥션이 닫히면, 브라우저는 문서를 보여준다.



## 웹의 구성 요소

### 프락시

프락시는 클라이언트 - 서버 사이에서 HTTP 요청을 전달하는 역할을 한다. 프락시는 보통 보안을 위해 사용한다. 보통 요청과 응답을 필터링 하는데, 회사에서 무엇인가를 다운 받을 때 어플리케이션 바이러스를 검출하거나 성인 컨텐츠를 차단하는 역할을 한다.

### 캐시

웹 캐시와 캐시 프락시는 정적 파일들을 저장해두는 창고 역할을 한다. 프락시에 정적 파일들을 캐시해두면 보다 빠르게 데이터를 받아볼 수 있다.

### 게이트웨이

다른 애플리케이션과 연결된 웹 서버로써 보통 HTTP를 다른 프로토콜로 변환해주는데 이용된다. HTTP를 FTP 프로토콜로 변환해서 문서를 가져올 때도 게이트웨이를 이용한다.



