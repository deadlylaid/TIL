# 싱글톤 패턴

생성 패턴의 하나

선언된 클래스에서 생성되는 객체는 글로벌에 단 하나로 한정하는 패턴을 말한다. 아래와 같은 이점을 갖는다.

- 클래스에 대한 단일 객체 생성
- 전역 객체 제공
- 공유된 리소스에 대한 동시 접근 제어

로깅, DB관련 작업 등에 사용된다.



#### 게으른 초기화

꼭 필요한 시점에 객체를 생성하는 방법



#### 모듈 임포트

파이썬의 임포트 방식은 기본적으로 모든 모듈이 싱글톤이다. 파이썬의 작동방식은 다음과 같다.

1. 파이썬 모듈이 임포트 되었는지 확인
2. 임포트됐다면 해당 객체를 반환, 아니면 임포트하고 인스턴스화 한다.
3. 모듈은 임포트와 동시에 초기화됨. 하지만 같은 모듈을 다시 임포트하면 싱글톤 패턴이므로 만들어진 객체를 반환한다.



#### 보그 패턴

싱글톤과 반대로 클래스에서 생성되는 여러개의 객체들이 하나의 상태를 공유한다는 패턴이다.



#### 싱글톤과 메타클래스

메타클래스는 클래스의 클래스다. 얘를 들어 MyClass 라는 객체가 있다면 MyKls라는 메타클래스를 생성해서 MyClass를 재정의할 수 있다. 자세한 예를 들어본다.

파이썬에서는 모든 것이 객체다. a=5 라면 type(a)는 `<type 'int'>` 를 반환한다. a 는 int 형 변수라는 뜻이다. 하지만 type(int)는 `<type 'type'>`을 반환한다. **int의 메타클래스가 type이라는 뜻이다.**

클래스는 메타클래스가 정의한다. class A 구문으로 클래스를 생성하면 파이썬은 `A = type(name, bases, dict)` 를 생성한다.

- name : 클래스명
- base : 베이스 클래스
- dict : 속성값

정의된 메타클래스가 있다면 파이썬은 `A = Meta(name, base, dict)` 를 생성한다.



#### 싱글톤의 단점

단일 전역 객체는 다음과 같은 문제점을 갖는다.

- 전역 변수 값이 실수로 변경되어도 이걸 모르고 애플리케이션에서 사용할 위험이 있다.
- 같은 객체에 대한 여러 참조자가 생길 수 있다.



#### 요약

- 애플리케이션을 개발할 때 스레드 풀과 캐시, 대화 상자, 레지스트리 설정 등 한 개의 객체만 필요한 경우가 많다.
- 싱글톤은 글로벌 액세스 지점을 제공하는, 단점이 거의 없는 패턴이다.
- 싱글톤 패턴의 단점은 전역 변수가 의도치 않게 다른 클래스에 영향을 줄 수 있다는 것. 자칫 리소스를 많이 사용하는 구조가 될 수 있다.



