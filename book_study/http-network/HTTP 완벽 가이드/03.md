# HTTP 메시지

이번 장에서 배우게 될 내용

- 메시지가 어디로 흘러가는가
- HTTP 메시지의 세 부분 (시작줄, 헤더, 개체 본문)
- 요청과 응답 메시지의 차이
- 요청 메시지가 지원하는 메소드
- 응답 메시지가 반환하는 상태 코드
- HTTP 헤더는 무슨 일을 하는가?

## 메시지의 흐름

HTTP 메시지는 클라이언트, 서버, 프록시 사이를 흐른다. `인바운드`, `아웃바운드`, `업스트림`, `다운스트림` 은 메시지의 방향을 의미한다.

클라이언트 -> 서버 방향은 인바운드, 서버 -> 클라이언트 방향은 아웃바운드이다.

### 다운스트림

HTTP 메시지는 요청, 응답 상관없이 다운스트림으로 흐른다.

```
클라이언트 -> 프락시1 -> 프락시2 -> 서버 -> 프락시2 -> 프락시1 -> 클라이언트
```

## 메시지의 각 부분

- 시작줄 : 어떤 메시지인지 서술
- 헤더 : 속성
- 본문 : 데이터

### 메시지 문법

요청 메시지의 형식

```
<메소드> <요청 URL> <버전>
<헤더>

<본문>
```

응답 메시지 형식
```
<버전> <상태 코드> <사유 구절>
<헤더>

<본문>
```

### 메소드
HTTP 는 쉽게 확장할 수 있도록 설계되었기 때문에 어떤 서버는 자기만의 메소드를 갖고 있을 수도 있다.

#### 상태 코드

- 100 ~ 199 : 정보
- 200 ~ 299 : 성공
- 300 ~ 399 : 리다이렉션
- 400 ~ 499 : 클라이언트 에러
- 500 ~ 599 : 서버 에러

### 헤더 부분

헤드 필드는 요청/응답에 메타 데이터를 추가한다. `:` 을 이용해서 key-value 목록이다.

#### 헤더 분류
HTTP 는 여러 헤드 필드를 정의한다.

| 헤더 예시                                    | 설명                                  |
| ---------------------------------------- | ----------------------------------- |
| Date:Tue, 3 Oct 1992 02:16:03 GMT        | 서버가 응답을 만들어낸 시각                     |
| Content-length: 10000                    | 10,000 바이트의 데이터를 포함한 엔터티 본문         |
| Accept: image/gif, image/jpeg, text/html | 클라이언트는 GIF, JPEG, html 을 받아들일 수 있다. |



### 메소드 종류

#### GET

원하는 데이터를 서버로부터 요청할 때 사용되는 메소드

#### HEAD

정확히 GET 처럼 행동하지만, 서버는 응답으로 헤더만 돌려준다. 같은 endpoint를 GET 요청을 보낼 때와 헤더가 정확히 일치해야한다.

#### PUT

서버에 있는 문서를 수정할 때 사용한다.

#### POST

서버에 데이터를 전송하는데 사용한다. HTML에서는 form과 POST를 이용해서 서버로 데이터를 전송하곤 한다.

#### TRACE 

클라이언트에서 요청이 발생하면, 그 요청은 방화벽, 프락시, 게이트웨이 등을 통과할 수 있다. TRACE 는 클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이게 되는지 알려준다.

#### OPTIONS

옵션 메소드는 웹 서버에게 여러 가지 종류의 지원 범위에 대해 물어본다.

#### DELETE

리소스 삭제를 요청한다.

## 헤더

헤더와 메소드는 클라이언트와 서버가 하는 행동을 결정하기 위해 사용된다.

- 일반 헤더, 요청 헤더, 응답 헤더, 엔터티 헤더 등이 있다.

**일반 헤더**

메시지에 대한 기본적인 정보를 제공한다. *Date, Connection, MIME-Version* 등이 이에 해당한다.

**요청 헤더**

요청 메시지에서만 존재하는 헤더를 말한다. *Client-IP, Host, From, Referer* 등이 이에 해당한다.

- 요청 보안 헤더
  - Authorization : 클라이어느가 서버에게 제공하는 인증 데이터를 다룬다.
  - cookie : 클라이언트가 서버에게 토큰을 전달할 때 사용한다.

**응답 헤더**

응답 헤더는 클라이언트에게 부가 정보를 전달한다.

- 응답 보안 헤더
  - Set-Cookie : 서버가 클라이언트를 인증할 수 있도록 클라이언트 측에 토큰을 설정하기 위해 사용한다.
  - WWW-Authenticate : 서버에서 클라이언트로 보낸 인증요구의 목록